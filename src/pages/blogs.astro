---
// /src/pages/blogs.astro
import Layout from "../layouts/Layout.astro";
import BlogGrid from "../components/BlogGrid.jsx";
import FancyText from "../components/FancyText.jsx";
import SplashScreen from "../components/SplashScreen.jsx";
import supabase from "../lib/supabase";

// Cargar blogs (solo info básica para las cards)
const { data: blogs, error } = await supabase
  .from("blogs")
  .select(
    `
    id,
    titulo,
    resumen,
    cover_img,
    fecha_publicacion,
    podcast_url,
    video_url,
    tipo_blog:tipo_blog ( 
      tipo
    ),
    autor:autor_id (
      nombre,
      apodo,
      foto_url
    )
  `,
  )
  .order("fecha_publicacion", { ascending: false });

if (error) throw error;
---

<Layout title="Blogs">
  <SplashScreen client:only="react" storageKey="visited-blogs" />

  <div class="min-h-screen bg-gradient-to-b from-gray-50 to-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      {/* Header Section */}
      <div class="text-center mb-16">
        <FancyText
          text="Nuestros Blogs"
          colors={["#3b82f6", "#10b981", "#3b82f6"]}
          animationSpeed={6}
          showBorder={false}
          className="text-5xl md:text-6xl font-extrabold tracking-tight mb-6"
          client:only="react"
        />
        <p class="text-xl text-gray-600 max-w-2xl mx-auto leading-relaxed">
          Descubre reflexiones, enseñanzas y recursos para tu crecimiento
          espiritual.
        </p>
      </div>

      {/* Interactive Grid */}
      <BlogGrid blogs={blogs} client:only="react" />
    </div>
  </div>
</Layout>
